$schema: "https://docs.renovatebot.com/renovate-schema.json"
extends:
  - "config:recommended"
  - ":label(renovate)"
  - ":prConcurrentLimitNone"
  - ":prHourlyLimitNone"
  - ":timezone(Asia/Tokyo)"
automerge: false
dependencyDashboard: false
branchConcurrentLimit: 0
baseBranches:
  - "main"
  - "master"
rangeStrategy: "auto"
packageRules:
  - groupName: "go"
    labels:
      - "go"
    matchDatasources:
      - "go"
  - groupName: "pypi"
    labels:
      - "pypi"
    matchDatasources:
      - "pypi"
  - groupName: "npm"
    labels:
      - "npm"
    matchDatasources:
      - "npm"
  - groupName: "rubygems"
    labels:
      - "rubuygems"
    matchDatasources:
      - "rubygems"
  - groupName: "nodejs/node"
    labels:
      - "nodejs/node"
    matchDepNames:
      - "nodejs/node"
  - groupName: "golang/go"
    labels:
      - "golang/go"
    matchDepNames:
      - "golang/go"
  - groupName: "ruby/ruby"
    labels:
      - "ruby/ruby"
    matchDepNames:
      - "ruby/ruby"
  - groupName: "python/cpython"
    labels:
      - "python/cpython"
    matchDepNames:
      - "python/cpython"
customManagers:
  - customType: "regex"
    fileMatch:
      - "^requirements/go.txt$"
    matchStrings:
      - "(?<depName>.*)@(?<currentValue>.*)"
    datasourceTemplate: "go"
  - customType: "regex"
    fileMatch:
      - "^requirements/python.txt$"
    matchStrings:
      - "(?<depName>.*)==(?<currentValue>.*)"
    datasourceTemplate: "pypi"
    versioningTemplate: "pep440"
  - customType: "regex"
    fileMatch:
      - "^requirements/node.txt$"
    matchStrings:
      - "(?<depName>.*)@(?<currentValue>.*)"
    datasourceTemplate: "npm"
    versioningTemplate: "npm"
  - customType: "regex"
    fileMatch:
      - "^requirements/gem.txt$"
    matchStrings:
      - "(?<depName>.*) -v (?<currentValue>\\d+\\.\\d+\\.\\d+)"
    datasourceTemplate: "rubygems"
    versioningTemplate: "semver"
  - customType: "regex"
    fileMatch:
      - "^bin/load-envs.sh$"
    matchStrings:
      - "export NODE_VERSION=(?<currentValue>v\\d+\\.\\d+\\.\\d+)"
    datasourceTemplate: "github-tags"
    depNameTemplate: "nodejs/node"
  - customType: "regex"
    fileMatch:
      - "^bin/load-envs.sh$"
    matchStrings:
      - "export GO_VERSION=(?<currentValue>\\d+\\.\\d+\\.\\d+)"
    datasourceTemplate: "github-tags"
    depNameTemplate: "golang/go"
    extractVersionTemplate: "^go(?<version>\\d+\\.\\d+\\.\\d+)$" # remove prefix `go` from datasource
  - customType: "regex"
    fileMatch:
      - "^bin/load-envs.sh$"
    matchStrings:
      - "export RB_VERSION=(?<currentValue>\\d+\\.\\d+\\.\\d+)"
    datasourceTemplate: "github-releases"
    depNameTemplate: "ruby/ruby"
  - customType: "regex"
    fileMatch:
      - "^bin/load-envs.sh$"
    matchStrings:
      - "export PY_VERSION=(?<currentValue>\\d+\\.\\d+\\.\\d+)"
    datasourceTemplate: "github-tags"
    depNameTemplate: "python/cpython"
    extractVersionTemplate: "^v(?<version>\\d+\\.\\d+\\.\\d+)$" # remove prefix `v` from datasource
